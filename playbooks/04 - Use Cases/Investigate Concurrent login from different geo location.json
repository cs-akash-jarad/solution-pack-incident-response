{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Investigate Concurrent login from different geo location",
    "aliasName": null,
    "tag": null,
    "description": "Investigates alerts of type \u2018Concurrent Login\u2019 by checking if the source IP address is in the specified CIDR range, and then performs remediation tasks based on the result.",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "lastModifyDate": 1636433420,
    "collection": "\/api\/3\/workflow_collections\/59667fcc-7feb-4ba4-a5a2-e03a9287f857",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/ae254279-0743-4b45-903b-8abe8b51ccb2",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "route": "2f236473-7f06-4a98-9976-4fc66330ef6f",
                "resources": [
                    "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                    "input": {
                        "records": "{{vars.input.records}}"
                    },
                    "alert_metadata": "{{vars.input.records[0].sourcedata | toDict}}"
                },
                "displayConditions": {
                    "alerts": {
                        "sort": [],
                        "limit": 30,
                        "logic": "AND",
                        "filters": [
                            {
                                "type": "object",
                                "field": "type",
                                "value": "\/api\/3\/picklists\/72459a5f-7759-4cff-a8ac-fa673113c4d0",
                                "_value": {
                                    "@id": "\/api\/3\/picklists\/72459a5f-7759-4cff-a8ac-fa673113c4d0",
                                    "display": "Concurrent Login",
                                    "itemValue": "Concurrent Login"
                                },
                                "operator": "eq"
                            }
                        ]
                    }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
            },
            "status": null,
            "top": "30",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
            "uuid": "ae254279-0743-4b45-903b-8abe8b51ccb2",
            "id": 3192
        },
        {
            "@type": "WorkflowStep",
            "name": "Configurations",
            "description": null,
            "arguments": {
                "destIP": "{{vars.alert_metadata.\nassociated_events.event_details[0][0].attributes.destIpAddr}}",
                "userid": "{{vars.alert_metadata.associated_events.event_details[0][0].attributes.srcUser}}",
                "HrEmail": "hr.dept@example.com",
                "username": "{{vars.alert_metadata.associated_events.event_details[0][0].attributes.userFullName}}",
                "ITdeptEmail": "it.dept@exampl.com",
                "VT_Threshold": "5",
                "useMockOutput": "{{globalVars.Demo_mode}}",
                "rawEventMessage": "DB Login Success",
                "internal_cidr_ranges": "193.200.225.0\/24"
            },
            "status": null,
            "top": "165",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "b6ad8c11-483d-4e17-9f22-b460dff3af14",
            "id": 3193
        },
        {
            "@type": "WorkflowStep",
            "name": "Retrieve Users Details From AD",
            "description": null,
            "arguments": {
                "name": "Active Directory",
                "config": "a5a06e4a-2523-49ef-8afc-b05ba05bf65f",
                "params": {
                    "cookie": "",
                    "page_size": "",
                    "size_limit": "",
                    "search_object": "User",
                    "search_attr_name": "Name",
                    "search_attr_value": "{{vars.userid}}"
                },
                "version": "2.1.1",
                "connector": "activedirectory",
                "operation": "global_search",
                "mock_result": "{\n  \"data\": {\n    \"cookie\": \"\",\n    \"entries\": [\n      {\n        \"dn\": \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\",\n        \"attributes\": {\n          \"c\": \"IN\",\n          \"l\": \"Pune\",\n          \"cn\": \"Tony Stark\",\n          \"co\": \"India\",\n          \"sn\": \"Stark\",\n          \"st\": \"Maharshtra\",\n          \"mail\": \"tonys@outlook.com\",\n          \"name\": \"Tony Stark\",\n          \"title\": \"System Engineer\",\n          \"manager\": \"CN=Bob M,CN=Users,DC=cspune,DC=com\",\n          \"codePage\": 0,\n          \"givenName\": \"Tony\",\n          \"lastLogon\": 1610694904,\n          \"objectSid\": \"S-1-5-21-3252237415-4094437703-262466058-1217\",\n          \"department\": \"IT\",\n          \"lastLogoff\": null,\n          \"logonCount\": 1610694981,\n          \"objectGUID\": \"{99c1d25e-d9f5-4f07-b9bf-ae0b1b4b2e0a}\",\n          \"postalCode\": \"412352\",\n          \"pwdLastSet\": 1603201135,\n          \"uSNChanged\": 100817,\n          \"uSNCreated\": 100808,\n          \"badPwdCount\": 0,\n          \"countryCode\": 356,\n          \"displayName\": \"Tony Stark\",\n          \"objectClass\": [\n            \"top\",\n            \"person\",\n            \"organizationalPerson\",\n            \"user\"\n          ],\n          \"whenChanged\": 1603201241,\n          \"whenCreated\": 1603201135,\n          \"instanceType\": 4,\n          \"accountExpires\": 253402300799,\n          \"objectCategory\": \"CN=Person,CN=Schema,CN=Configuration,DC=cspune,DC=com\",\n          \"primaryGroupID\": 513,\n          \"sAMAccountName\": \"tonys\",\n          \"sAMAccountType\": \"SAM_NORMAL_USER_ACCOUNT\",\n          \"badPasswordTime\": null,\n          \"distinguishedName\": \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\",\n          \"userPrincipalName\": \"example@mail.com\",\n          \"userAccountControl\": \"USER_ACCOUNT_DISABLED | NORMAL_ACCOUNT\",\n          \"dSCorePropagationData\": [\n            1603201135,\n            null\n          ]\n        }\n      }\n    ]\n  },\n  \"status\": \"Success\",\n  \"_status\": true,\n  \"message\": \"\",\n  \"operation\": null,\n  \"request_id\": null\n}",
                "operationTitle": "Global Search",
                "step_variables": {
                    "userEmail": "{{vars.result.data.entries[0].attributes.mail}}",
                    "userLoginTime": "{{vars.result.data.entries[0].attributes.lastLogon}}"
                }
            },
            "status": null,
            "top": "840",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "c58f7954-05bb-4cc5-90c9-5e8db4ac173b",
            "id": 3194
        },
        {
            "@type": "WorkflowStep",
            "name": "Notify User Login disable for one hour",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Received approval from IT Team and user account is disabled.\n\nEmail is sent to User with subject \"{{vars.result.subject}}\"",
                    "records": "{{vars.input.records[0]['@id']}}"
                },
                "resource": {
                    "to": "{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.mail}}",
                    "body": "Hi {{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.name}},\n\nWe have observed concurrent login to your account from different geographyical locations\n{% for i in vars.alert_metadata.associated_events.event_details %}\n<li>Location : {{i[0].attributes.srcGeoCountry}}<\/li>\n<li> SourceIP : {{i[0].attributes.srcIpAddr}}<\/li>\n <li>Time : {{i[0].attributes.deviceTime}}\n {%endfor%}\n \n hence we are disabling your account for an hour.Incase of any query Please contact IT Help Desk.\n \n Thank you!",
                    "from": "{{globalVars.Default_Email}}",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "subject": "Account is disable for 1 hour",
                    "__replace": "",
                    "msgDirection": {
                        "id": 278,
                        "@id": "\/api\/3\/picklists\/971d37f3-738a-43e7-93ff-f39c6686e933",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Draft",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/09b97c81-669a-4ac8-8668-920913f3329b",
                        "itemValue": "Draft",
                        "orderIndex": 2
                    }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/communication",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2055",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "cd3b0220-8f56-4ec9-96fb-e1481995c05d",
            "id": 3195
        },
        {
            "@type": "WorkflowStep",
            "name": "Send Approval for Login Disable",
            "description": null,
            "arguments": {
                "resource": {
                    "method": {
                        "id": 116,
                        "@id": "\/api\/3\/picklists\/7a04788b-5128-4288-a0fc-6e82d18c3b7b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "System",
                        "listName": "\/api\/3\/picklist_names\/d7bdd0ba-d721-4324-bec5-410e23f0f485",
                        "itemValue": "System",
                        "orderIndex": 1
                    },
                    "owners": [
                        "\/api\/3\/teams\/6e569c09-3bd4-40f1-98b0-cc994464c3c5"
                    ],
                    "status": {
                        "id": 207,
                        "@id": "\/api\/3\/picklists\/d26464e0-1df4-46c2-a032-018911ba0c40",
                        "icon": null,
                        "uuid": "d26464e0-1df4-46c2-a032-018911ba0c40",
                        "@type": "Picklist",
                        "color": "#bf9937",
                        "listName": "\/api\/3\/picklist_names\/ce294c1f-9318-425f-9a12-2957292f4cbf",
                        "itemValue": "Pending",
                        "orderIndex": 2
                    },
                    "playbookiri": "api\/3\/workflows\/4719c477-28f5-4d8d-9022-f70fe75ccb3d",
                    "playbookname": "Investigate Concurrent login from different geo location",
                    "playbookuuid": "4719c477-28f5-4d8d-9022-f70fe75ccb3d",
                    "approvaldescription": "Approve user disable operation in active directory -\n{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.name}}\nFound concurrent Login attempt from different geo location"
                },
                "collection": "approvals",
                "step_variables": []
            },
            "status": null,
            "top": "1785",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/6832e556-b9c7-497a-babe-feda3bd27dcg",
            "uuid": "a3ec6867-2bcd-442a-aefe-100d298b494b",
            "id": 3196
        },
        {
            "@type": "WorkflowStep",
            "name": "Start Investigation",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Investigating Potential {{vars.input.records[0].type.itemValue}}, with following fields of interest:\n{% if vars.input.records[0].domain %}Domain: {{vars.input.records[0].domain -}}{% endif %}\n{% if vars.input.records[0].sourceIp %}SourceIP: {{ vars.input.records[0].sourceIp -}}{% endif %}\n{% if vars.input.records[0].destinationIp %}DestinationIP: {{vars.input.records[0].destinationIp -}}{% endif %}\n{% if vars.input.records[0].fileHash %}File Hash: {{vars.input.records[0].fileHash -}}{% endif %}\n{% if vars.input.records[0].computerName %}ComputerName: {{vars.input.records[0].computerName -}}{% endif %}\n{% if vars.input.records[0].processName %}Process: {{vars.input.records[0].processName -}}{% endif %}\n{% if vars.input.records[0].sourceProcess %}SourceProcess: {{vars.input.records[0].sourceProcess -}}{% endif %}\n<br>\n\nObserved Concurrent Login To Account from Below different Geo Location\n{% for i in vars.alert_metadata.associated_events.event_details %}\n* Location : {{i[0].attributes.srcGeoCountry}}\n* SourceIP : {{i[0].attributes.srcIpAddr}}\n {%endfor%}",
                    "records": ""
                },
                "resource": {
                    "status": {
                        "id": 113,
                        "@id": "\/api\/3\/picklists\/758925e7-629c-46d8-89db-fb36f5fbe88a",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Investigating",
                        "listName": "\/api\/3\/picklist_names\/33e964a9-d607-49f2-813c-7ce46141815a",
                        "itemValue": "Investigating",
                        "orderIndex": 2
                    }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "300",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "33b35050-1dd5-47e2-911c-184dd9800c8b",
            "id": 3197
        },
        {
            "@type": "WorkflowStep",
            "name": "Match Source IP in Internal CIDR",
            "description": null,
            "arguments": {
                "name": "CyOps Utilities",
                "params": {
                    "cidr": "{{vars.internal_cidr_ranges}}",
                    "ip_address": "{{vars.item[0].attributes.srcIpAddr}}"
                },
                "version": "3.0.5",
                "for_each": {
                    "item": "{{vars.alert_metadata.associated_events.event_details}}",
                    "condition": ""
                },
                "connector": "cyops_utilities",
                "operation": "ip_cidr_check",
                "operationTitle": "Utils: Is IP in CIDR",
                "step_variables": [],
                "operationOutput": {
                    "matched_ips": [],
                    "unmatched_ips": []
                }
            },
            "status": null,
            "top": "435",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "99d2df5b-2a8e-4af5-9523-4a1abe337fb5",
            "id": 3198
        },
        {
            "@type": "WorkflowStep",
            "name": "Is Source IP internal",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Internal",
                        "step_iri": "\/api\/3\/workflow_steps\/983bf3d4-3344-44c4-b4f3-da042d550a94",
                        "condition": "{{ vars.steps.Match_Source_IP_in_Internal_CIDR.data['matched_cidr_ip']  |  length > 0 }}",
                        "step_name": "Create Note for Internal IP"
                    },
                    {
                        "option": "External",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/c1a7e070-e18c-4680-bea5-c1347ee798a5",
                        "step_name": "Create Note for External IP"
                    }
                ]
            },
            "status": null,
            "top": "570",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "uuid": "7eed68ec-db16-41cd-a648-1ba0e5193ae4",
            "id": 3199
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Note for Internal IP",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.alert_metadata.aassociated_events.event_details}}",
                    "__bulk": true,
                    "condition": "",
                    "batch_size": 100
                },
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "[\"{{vars.input.records[0]['@id']}}\"]",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p> Source IP: <strong><\/strong><\/p><li><strong>{{vars.item[0].attributes.srcIpAddr}}<\/strong><\/li> is&nbsp;<span style=\"color: #00ff00;\"><strong>Internal and therfore benign<\/strong><\/span><p><\/p>\n",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "705",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "983bf3d4-3344-44c4-b4f3-da042d550a94",
            "id": 3200
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Note for External IP",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.alert_metadata.associated_events.event_details}}",
                    "__bulk": true,
                    "condition": "",
                    "batch_size": 100
                },
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "[\"{{vars.input.records[0]['@id']}}\"]",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p> <span style=\"font-size: 15px; color: #DE7A13;\" class=\"fa fa-exclamation-triangle\"><\/span>&nbsp;Source IP<strong> {{vars.item[0].attributes.srcIpAddr}} is <\/strong><span style=\"background:#e31b1d; color: #fff;\" class=\"badge badge-pill badge-danger\">External<\/span><\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "705",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "c1a7e070-e18c-4680-bea5-c1347ee798a5",
            "id": 3201
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for User Details",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Below are end user's Detais found on AD :<\/p>\n<ul style=\"list-style-type: square;\">\n<li><strong>Name<\/strong>:&nbsp;{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.name}}<\/li>\n<li><strong>Email Address<\/strong>:&nbsp;{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.mail}}<\/li>\n<li><strong>Manager Name<\/strong>:&nbsp;{{vars.steps.Retrieve_Manager_Email_Address.data.entries[0].attributes.name}}<\/li>\n<li><strong>Manager's Email Address<\/strong>:&nbsp;{{vars.steps.Retrieve_Manager_Email_Address.data.entries[0].attributes.mail}}<\/li><\/ul>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1110",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "76a3daff-cdc0-40c3-9191-50398287a45f",
            "id": 3202
        },
        {
            "@type": "WorkflowStep",
            "name": "Retrieve Manager Email Address",
            "description": null,
            "arguments": {
                "name": "Active Directory",
                "config": "598c4c8c-08a8-4491-bcb8-2223cb53fc57",
                "params": {
                    "cookie": "",
                    "page_size": "",
                    "size_limit": "",
                    "search_object": "User",
                    "search_attr_name": "Distinguished Name",
                    "search_attr_value": "{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.manager}}"
                },
                "version": "2.1.1",
                "connector": "activedirectory",
                "operation": "global_search",
                "mock_result": "{\n  \"data\": {\n    \"cookie\": \"\",\n    \"entries\": [\n      {\n        \"dn\": \"CN=Bob M,CN=Users,DC=cspune,DC=com\",\n        \"attributes\": {\n          \"c\": \"IN\",\n          \"l\": \"pune\",\n          \"cn\": \"Bob M\",\n          \"co\": \"India\",\n          \"sn\": \"k\",\n          \"st\": \"MH\",\n          \"info\": \"test\",\n          \"mail\": \"bobm@outlook.com\",\n          \"name\": \"Bob M\",\n          \"mobile\": \"9975865053\",\n          \"manager\": \"CN=Robert Banner,CN=Users,DC=cspune,DC=com\",\n          \"codePage\": 0,\n          \"memberOf\": [\n            \"CN=Remote Management Users,CN=Builtin,DC=cspune,DC=com\",\n            \"CN=Remote Desktop Users,CN=Builtin,DC=cspune,DC=com\",\n            \"CN=Administrators,CN=Builtin,DC=cspune,DC=com\"\n          ],\n          \"givenName\": \"bob\",\n          \"lastLogon\": 1603281092,\n          \"objectSid\": \"S-1-5-21-3252237415-4094437703-262466058-1108\",\n          \"adminCount\": 1,\n          \"lastLogoff\": null,\n          \"logonCount\": 164,\n          \"objectGUID\": \"{e64e35bb-2a69-4405-9f20-c8168cf7366f}\",\n          \"postalCode\": \"411045\",\n          \"pwdLastSet\": 1573025485,\n          \"uSNChanged\": 100806,\n          \"uSNCreated\": 35945,\n          \"badPwdCount\": 0,\n          \"countryCode\": 356,\n          \"displayName\": \"bob m\",\n          \"objectClass\": [\n            \"top\",\n            \"person\",\n            \"organizationalPerson\",\n            \"user\"\n          ],\n          \"whenChanged\": 1603200696,\n          \"whenCreated\": 1573025291,\n          \"instanceType\": 4,\n          \"directReports\": [\n            \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\"\n          ],\n          \"accountExpires\": 253402300799,\n          \"objectCategory\": \"CN=Person,CN=Schema,CN=Configuration,DC=cspune,DC=com\",\n          \"primaryGroupID\": 513,\n          \"sAMAccountName\": \"bob\",\n          \"sAMAccountType\": \"SAM_NORMAL_USER_ACCOUNT\",\n          \"badPasswordTime\": 1601019205,\n          \"distinguishedName\": \"CN=bob m,CN=Users,DC=cspune,DC=com\",\n          \"userPrincipalName\": \"bobm@cspune.com\",\n          \"lastLogonTimestamp\": 1602583384,\n          \"userAccountControl\": \"NORMAL_ACCOUNT | DONT_EXPIRE_PASSWORD\",\n          \"dSCorePropagationData\": [\n            1595571543,\n            1573027969,\n            null\n          ],\n          \"physicalDeliveryOfficeName\": \"Jarvis, pune\",\n          \"msDS-SupportedEncryptionTypes\": 0\n        }\n      }\n    ]\n  },\n  \"status\": \"Success\",\n  \"_status\": true,\n  \"message\": \"\",\n  \"operation\": null,\n  \"request_id\": null\n}",
                "operationTitle": "Global Search",
                "pickFromTenant": false,
                "step_variables": {
                    "manager_email": "{{vars.result.data.entries[0].attributes.email}}"
                }
            },
            "status": null,
            "top": "975",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "f6669d66-6a7d-47da-a3a9-bc67c693f792",
            "id": 3203
        },
        {
            "@type": "WorkflowStep",
            "name": "Disable User Login",
            "description": null,
            "arguments": {
                "name": "Active Directory",
                "config": "ef96f61a-6f92-4f1c-ad93-e6d1eefc3aba",
                "params": {
                    "search_attr_name": "Email",
                    "search_attr_value": "{{vars.userEmail}}"
                },
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "User {{vars.userid}} Account is Disabled for 1 hour",
                    "records": ""
                },
                "version": "2.1.1",
                "connector": "activedirectory",
                "operation": "disable_user_account",
                "mock_result": "{\n     \"description\": \"Disabled User Account\",\n     \"type\": \"Email\",\n     \"referrals\": \"\",\n     \"dn\": \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\",\n     \"result\": \"Disabled\",\n     \"message\": \"Successful\"\n}",
                "operationTitle": "Disable User Account",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "2190",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "7a18540b-2657-4078-828b-239494ae06ca",
            "id": 3204
        },
        {
            "@type": "WorkflowStep",
            "name": "Reset Password",
            "description": null,
            "arguments": {
                "name": "Active Directory",
                "config": "ef96f61a-6f92-4f1c-ad93-e6d1eefc3aba",
                "params": {
                    "new_password": "Demo@1234",
                    "search_attr_name": "Email",
                    "search_attr_value": "{{vars.userEmail}}"
                },
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Reset the User Password after an Hour",
                    "records": "{{vars.input.records[0]['@id']}}"
                },
                "version": "2.1.1",
                "connector": "activedirectory",
                "operation": "reset_password",
                "mock_result": "{\n     \"description\": \"Reset User Password\",\n     \"type\": \"Email\",\n     \"referrals\": \"\",\n     \"dn\": \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\",\n     \"result\": \"Reset Password\",\n     \"message\": \"Successful\"\n}",
                "operationTitle": "Reset Password",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "3000",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "3594b31e-4591-4040-a8e7-c90cbaba2dea",
            "id": 3205
        },
        {
            "@type": "WorkflowStep",
            "name": "Send Email to Manager and IT",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Notified User, Manager, IT Team about Password Reset though Email, please check communications for more details.",
                    "records": "{{vars.input.records[0]['@id']}}"
                },
                "resource": {
                    "cc": "{{vars.manager_email}}",
                    "to": "{{vars.userEmail}}",
                    "bcc": "{{vars.ITdeptEmail}}",
                    "body": "<p>Hello Team<\/p><\/br>\nWe have observed Multiple Concurrent Login Attempt for User : <b>{{vars.username}}<\/b> and We Reset The password for the user.\n\nThank you.",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "subject": "Notify User, Manager, IT Team about Password Reset",
                    "__replace": "",
                    "msgDirection": {
                        "id": 278,
                        "@id": "\/api\/3\/picklists\/971d37f3-738a-43e7-93ff-f39c6686e933",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Draft",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/09b97c81-669a-4ac8-8668-920913f3329b",
                        "itemValue": "Draft",
                        "orderIndex": 2
                    }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/communication",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "3135",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "f0eab3eb-f63b-45f6-9d3a-ab8a052e0c78",
            "id": 3206
        },
        {
            "@type": "WorkflowStep",
            "name": "Check if Approved",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Approved",
                        "step_iri": "\/api\/3\/workflow_steps\/cd3b0220-8f56-4ec9-96fb-e1481995c05d",
                        "condition": "{{ vars.steps.Send_Approval_for_Login_Disable.approved == true }}",
                        "step_name": "Notify User Login disable for one hour"
                    },
                    {
                        "option": "Not Approved",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/87934093-0853-4919-9a17-67ea3f6ea89f",
                        "step_name": "Add Note for Not Approved"
                    }
                ]
            },
            "status": null,
            "top": "1920",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "uuid": "f7aa52eb-d5d6-446b-9ef1-6d0854edc2d1",
            "id": 3207
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for Not Approved",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "**User Not Approved to Disable the {{vars.username}} Login.**",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2055",
            "left": "650",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "87934093-0853-4919-9a17-67ea3f6ea89f",
            "id": 3208
        },
        {
            "@type": "WorkflowStep",
            "name": "Search users 4 hours of login data in fortisiem",
            "description": null,
            "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "f3a47c5b-8a10-4dfc-9f30-d09778821e57",
                "params": {
                    "start": 0,
                    "value": 4,
                    "perPage": 50,
                    "rel_time": "Hours",
                    "attribute": [
                        "Destination IP",
                        "Raw Event Log"
                    ],
                    "select_clause": "phRecvTime,reptDevIpAddr,eventType,eventName,srcIpAddr,destIpAddr,user,rawEventMsg",
                    "time_selection": "Relative Time",
                    "raw_event_log_value": "{{vars.rawEventMessage}}",
                    "destination_ip_value": "{{vars.destIP}}"
                },
                "version": "4.1.0",
                "connector": "fortinet-fortisiem",
                "operation": "search_events",
                "mock_result": "{\n  \"data\": {\n    \"@start\": \"0\",\n    \"events\": [\n      {\n        \"id\": \"7574069411033098795\",\n        \"nid\": \"7574069411033098795\",\n        \"index\": \"0\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:49:48 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:19:47 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='27.60.168.208' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145187530 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:19:47.530' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:49:48+05:30\"\n      },\n      {\n        \"id\": \"7574069411033008504\",\n        \"nid\": \"7574069411033008504\",\n        \"index\": \"1\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:48:39 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:18:39 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='37.32.125.134' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145119058 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:18:39.058' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:48:39+05:30\"\n      },\n      {\n        \"id\": \"7574069411033098795\",\n        \"nid\": \"7574069411033098795\",\n        \"index\": \"0\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:30:48 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:19:47 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='27.60.168.208' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145187530 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:19:47.530' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:49:48+05:30\"\n      },\n      {\n        \"id\": \"7574069411033008504\",\n        \"nid\": \"7574069411033008504\",\n        \"index\": \"1\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:22:39 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:18:39 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='37.32.125.134' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145119058 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:18:39.058' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:22:39+05:30\"\n      },\n      {\n        \"id\": \"7574069411033008504\",\n        \"nid\": \"7574069411033008504\",\n        \"index\": \"1\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:05:39 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:18:39 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='37.32.125.134' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145119058 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:18:39.058' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:05:39+05:30\"\n      },\n      {\n        \"id\": \"7574069411033008504\",\n        \"nid\": \"7574069411033008504\",\n        \"index\": \"1\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 16:05:39 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:18:39 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='37.32.125.134' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145119058 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:18:39.058' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T16:05:39+05:30\"\n      }\n    ],\n    \"@queryId\": \"690845,1611173376077\",\n    \"@errorCode\": \"0\",\n    \"@totalCount\": \"6\"\n  },\n  \"status\": \"Success\",\n  \"_status\": true,\n  \"message\": \"\",\n  \"operation\": null,\n  \"request_id\": null\n}",
                "operationTitle": "Search Events",
                "pickFromTenant": false,
                "step_variables": {
                    "topFiveEvents": "{{vars.result.data.events[:5]}}"
                }
            },
            "status": null,
            "top": "1245",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "b1c2486d-7a61-4543-8792-b140621133cf",
            "id": 3209
        },
        {
            "@type": "WorkflowStep",
            "name": "convert CEF to json",
            "description": null,
            "arguments": {
                "params": {
                    "cef_input": "{{vars.item.attributes.rawEventMsg}}"
                },
                "version": "3.0.5",
                "for_each": {
                    "item": "{{vars.topFiveEvents}}",
                    "condition": ""
                },
                "connector": "cyops_utilities",
                "operation": "parse_cef",
                "operationTitle": "FSR: Parse CEF String to JSON.",
                "step_variables": []
            },
            "status": null,
            "top": "1380",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "a219b03c-e587-43ad-9cf1-c1f536ad50fd",
            "id": 3210
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note to Alert with searched data",
            "description": null,
            "arguments": {
                "params": {
                    "data": "{{vars.item.data}}",
                    "display": "Vertical",
                    "styling": false,
                    "template": "Stylized with row selection",
                    "row_fields": ""
                },
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Below are the user's 4 hours of login data,displaying top 5 logs:\n<br>\n\n{%for i in vars.result%}\n{{i.data}}\n {%endfor%}",
                    "records": "{{vars.input.records[0]['@id']}}"
                },
                "version": "3.1.1",
                "for_each": {
                    "item": "{{vars.steps.convert_CEF_to_json}}",
                    "condition": ""
                },
                "connector": "cyops_utilities",
                "operation": "json_to_html",
                "operationTitle": "Utils: Convert JSON into a HTML Table",
                "step_variables": []
            },
            "status": null,
            "top": "1515",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "6f86c9c1-b1a9-45e4-8ce0-f739cf20e629",
            "id": 3211
        },
        {
            "@type": "WorkflowStep",
            "name": "check if Login Attempted in last 10 min",
            "description": null,
            "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "f3a47c5b-8a10-4dfc-9f30-d09778821e57",
                "params": {
                    "start": 0,
                    "value": 10,
                    "perPage": "",
                    "rel_time": "Minutes",
                    "attribute": [
                        "Destination IP",
                        "Raw Event Log"
                    ],
                    "select_clause": "phRecvTime,reptDevIpAddr,eventType,eventName,srcIpAddr,destIpAddr,user,rawEventMsg",
                    "time_selection": "Relative Time",
                    "raw_event_log_value": "{{vars.rawEventMessage}}",
                    "destination_ip_value": "{{vars.destIP}}"
                },
                "version": "4.1.0",
                "connector": "fortinet-fortisiem",
                "operation": "search_events",
                "mock_result": "{\n  \"data\": {\n    \"@start\": \"0\",\n    \"events\": [],\n    \"@queryId\": \"690867,1611177163837\",\n    \"@errorCode\": \"0\",\n    \"@totalCount\": \"0\"\n  },\n  \"status\": \"Success\",\n  \"_status\": true,\n  \"message\": \"\",\n  \"operation\": null,\n  \"request_id\": null\n}",
                "operationTitle": "Search Events",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "2595",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "335bf175-6398-469d-84ee-b58b662b1bc8",
            "id": 3212
        },
        {
            "@type": "WorkflowStep",
            "name": "Check if Login Attempted",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Yes",
                        "step_iri": "\/api\/3\/workflow_steps\/54eb3995-3ecb-4677-bb47-d850998381e8",
                        "condition": "{{ vars.steps.check_if_Login_Attempted_in_last_10_min.data.events | length > 0 }}",
                        "step_name": "Add Note for Login Attempt"
                    },
                    {
                        "option": "No",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/c625b379-5b98-4c24-a85c-5ad3d3d60859",
                        "step_name": "Add note for login is not attempted"
                    }
                ]
            },
            "status": null,
            "top": "2730",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "uuid": "f9560ddc-ca6d-4ab0-bd11-7cccb9a0f53e",
            "id": 3213
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for Login Attempt",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Observed that login is attempted for last an hour",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2865",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "54eb3995-3ecb-4677-bb47-d850998381e8",
            "id": 3214
        },
        {
            "@type": "WorkflowStep",
            "name": "Add note for login is not attempted",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Observed that login is not attempted for last an hour",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2865",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "c625b379-5b98-4c24-a85c-5ad3d3d60859",
            "id": 3215
        },
        {
            "@type": "WorkflowStep",
            "name": "Wait for 1 hour",
            "description": null,
            "arguments": {
                "delay": {
                    "days": 0,
                    "hours": 0,
                    "weeks": 0,
                    "minutes": 1,
                    "seconds": 0
                }
            },
            "status": null,
            "top": "2460",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/6832e556-b9c7-497a-babe-feda3bd27dbf",
            "uuid": "da4034be-85c6-470d-bd38-1621cf96c51f",
            "id": 3216
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for Approval",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Sent Approval Request To **IT Team** to Disable User Account",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1650",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "15457e8e-fc0a-4eaf-a53a-05113fed1469",
            "id": 3217
        },
        {
            "@type": "WorkflowStep",
            "name": "Add note for pause",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Automation workflow snoozed for an hour, Post that we will query for any successfull login attempt",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2325",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "9a955927-7e0f-42ba-b301-f550e778293f",
            "id": 3218
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configurations",
            "targetStep": "\/api\/3\/workflow_steps\/b6ad8c11-483d-4e17-9f22-b460dff3af14",
            "sourceStep": "\/api\/3\/workflow_steps\/ae254279-0743-4b45-903b-8abe8b51ccb2",
            "label": null,
            "isExecuted": false,
            "uuid": "03236324-d216-46d5-b7a6-fdad6e3b80f3"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Match Source IP in Internal CIDR -> Is Source IP internal",
            "targetStep": "\/api\/3\/workflow_steps\/7eed68ec-db16-41cd-a648-1ba0e5193ae4",
            "sourceStep": "\/api\/3\/workflow_steps\/99d2df5b-2a8e-4af5-9523-4a1abe337fb5",
            "label": null,
            "isExecuted": false,
            "uuid": "dbbe9f34-cdaf-4b2f-8444-f60794bc80c6"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configurations -> Start Investigation",
            "targetStep": "\/api\/3\/workflow_steps\/33b35050-1dd5-47e2-911c-184dd9800c8b",
            "sourceStep": "\/api\/3\/workflow_steps\/b6ad8c11-483d-4e17-9f22-b460dff3af14",
            "label": null,
            "isExecuted": false,
            "uuid": "700d6d1a-f12d-4183-bf48-4c110718bdf9"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start Investigation -> Match Source IP in Internal CIDR",
            "targetStep": "\/api\/3\/workflow_steps\/99d2df5b-2a8e-4af5-9523-4a1abe337fb5",
            "sourceStep": "\/api\/3\/workflow_steps\/33b35050-1dd5-47e2-911c-184dd9800c8b",
            "label": null,
            "isExecuted": false,
            "uuid": "005f0cd6-66bc-4e64-a6dc-eb6cb24c9639"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Source IP internal -> Create Note for Internal IP",
            "targetStep": "\/api\/3\/workflow_steps\/983bf3d4-3344-44c4-b4f3-da042d550a94",
            "sourceStep": "\/api\/3\/workflow_steps\/7eed68ec-db16-41cd-a648-1ba0e5193ae4",
            "label": "Internal",
            "isExecuted": false,
            "uuid": "ee8329bd-f9c9-4e05-8e60-ef48abee7426"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Source IP internal -> Create Note for External IP",
            "targetStep": "\/api\/3\/workflow_steps\/c1a7e070-e18c-4680-bea5-c1347ee798a5",
            "sourceStep": "\/api\/3\/workflow_steps\/7eed68ec-db16-41cd-a648-1ba0e5193ae4",
            "label": "External",
            "isExecuted": false,
            "uuid": "87b3119b-4cf3-4f34-a018-c7012cdb6e03"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Retrieve Users Details From AD -> Retrieve Manager Email Address",
            "targetStep": "\/api\/3\/workflow_steps\/f6669d66-6a7d-47da-a3a9-bc67c693f792",
            "sourceStep": "\/api\/3\/workflow_steps\/c58f7954-05bb-4cc5-90c9-5e8db4ac173b",
            "label": null,
            "isExecuted": false,
            "uuid": "a03380af-00c3-48c1-8495-4402bac0c47c"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Retrieve Manager Email Address -> Add Note for User Details",
            "targetStep": "\/api\/3\/workflow_steps\/76a3daff-cdc0-40c3-9191-50398287a45f",
            "sourceStep": "\/api\/3\/workflow_steps\/f6669d66-6a7d-47da-a3a9-bc67c693f792",
            "label": null,
            "isExecuted": false,
            "uuid": "f4b133bd-31ac-4417-befd-a93eb79a1be7"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Reset Password -> Notify Manager about Password Reset",
            "targetStep": "\/api\/3\/workflow_steps\/f0eab3eb-f63b-45f6-9d3a-ab8a052e0c78",
            "sourceStep": "\/api\/3\/workflow_steps\/3594b31e-4591-4040-a8e7-c90cbaba2dea",
            "label": null,
            "isExecuted": false,
            "uuid": "8500c5a8-6188-428a-af00-7f5d93ce603a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Notify User Login disable for one hour -> Disable User Login",
            "targetStep": "\/api\/3\/workflow_steps\/7a18540b-2657-4078-828b-239494ae06ca",
            "sourceStep": "\/api\/3\/workflow_steps\/cd3b0220-8f56-4ec9-96fb-e1481995c05d",
            "label": null,
            "isExecuted": false,
            "uuid": "f695b9f4-cc34-482c-90a4-ae0865f150e8"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Send Approval for Login Disable -> Check if Approved",
            "targetStep": "\/api\/3\/workflow_steps\/f7aa52eb-d5d6-446b-9ef1-6d0854edc2d1",
            "sourceStep": "\/api\/3\/workflow_steps\/a3ec6867-2bcd-442a-aefe-100d298b494b",
            "label": null,
            "isExecuted": false,
            "uuid": "f35cd231-e6a4-40c6-9645-cef35083e4ff"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check if Approved -> Notify User Login disable for one hour",
            "targetStep": "\/api\/3\/workflow_steps\/cd3b0220-8f56-4ec9-96fb-e1481995c05d",
            "sourceStep": "\/api\/3\/workflow_steps\/f7aa52eb-d5d6-446b-9ef1-6d0854edc2d1",
            "label": "Approved",
            "isExecuted": false,
            "uuid": "af5983ac-3a21-42c7-add8-f15ae9a7b4c6"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check if Approved -> Add Note for Not Approved",
            "targetStep": "\/api\/3\/workflow_steps\/87934093-0853-4919-9a17-67ea3f6ea89f",
            "sourceStep": "\/api\/3\/workflow_steps\/f7aa52eb-d5d6-446b-9ef1-6d0854edc2d1",
            "label": "Not Approved",
            "isExecuted": false,
            "uuid": "8d139f02-a12d-443a-ad87-1944d593de73"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create Note for External IP -> Retrieve Users Details From AD",
            "targetStep": "\/api\/3\/workflow_steps\/c58f7954-05bb-4cc5-90c9-5e8db4ac173b",
            "sourceStep": "\/api\/3\/workflow_steps\/c1a7e070-e18c-4680-bea5-c1347ee798a5",
            "label": null,
            "isExecuted": false,
            "uuid": "2170a030-0b4c-4fed-a253-0ba0ed3c5a3e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "convert CEF to json -> Add Note to Alert with searched data",
            "targetStep": "\/api\/3\/workflow_steps\/6f86c9c1-b1a9-45e4-8ce0-f739cf20e629",
            "sourceStep": "\/api\/3\/workflow_steps\/a219b03c-e587-43ad-9cf1-c1f536ad50fd",
            "label": null,
            "isExecuted": false,
            "uuid": "a4be4a96-f1c2-45fb-988d-c8640b9c54f6"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note for User Details -> searching users 4 hours of login data in fortisiem",
            "targetStep": "\/api\/3\/workflow_steps\/b1c2486d-7a61-4543-8792-b140621133cf",
            "sourceStep": "\/api\/3\/workflow_steps\/76a3daff-cdc0-40c3-9191-50398287a45f",
            "label": null,
            "isExecuted": false,
            "uuid": "45cb8b1c-fe7a-4f38-b083-d6f3c8122ba0"
        },
        {
            "@type": "WorkflowRoute",
            "name": "check if Login Attempted in last 10 min -> Check if Login Attempted",
            "targetStep": "\/api\/3\/workflow_steps\/f9560ddc-ca6d-4ab0-bd11-7cccb9a0f53e",
            "sourceStep": "\/api\/3\/workflow_steps\/335bf175-6398-469d-84ee-b58b662b1bc8",
            "label": null,
            "isExecuted": false,
            "uuid": "93ca177f-1327-4fd6-beb0-1b544505b90a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note for Login Attempt -> Reset Password",
            "targetStep": "\/api\/3\/workflow_steps\/3594b31e-4591-4040-a8e7-c90cbaba2dea",
            "sourceStep": "\/api\/3\/workflow_steps\/54eb3995-3ecb-4677-bb47-d850998381e8",
            "label": null,
            "isExecuted": false,
            "uuid": "f3ac4b08-ec35-4179-bacd-afb8dc4e9184"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add note for login is not attempted -> Reset Password",
            "targetStep": "\/api\/3\/workflow_steps\/3594b31e-4591-4040-a8e7-c90cbaba2dea",
            "sourceStep": "\/api\/3\/workflow_steps\/c625b379-5b98-4c24-a85c-5ad3d3d60859",
            "label": null,
            "isExecuted": false,
            "uuid": "c02b2477-8ea5-4543-ba95-e5d3ccaa28e7"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check if Login Attempted -> Add Note for Login Attempt",
            "targetStep": "\/api\/3\/workflow_steps\/54eb3995-3ecb-4677-bb47-d850998381e8",
            "sourceStep": "\/api\/3\/workflow_steps\/f9560ddc-ca6d-4ab0-bd11-7cccb9a0f53e",
            "label": "Yes",
            "isExecuted": false,
            "uuid": "ba7e7e14-1473-48a7-83da-ae0341095f56"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check if Login Attempted -> Add note for login is not attempted",
            "targetStep": "\/api\/3\/workflow_steps\/c625b379-5b98-4c24-a85c-5ad3d3d60859",
            "sourceStep": "\/api\/3\/workflow_steps\/f9560ddc-ca6d-4ab0-bd11-7cccb9a0f53e",
            "label": "No",
            "isExecuted": false,
            "uuid": "9f9c5076-5e28-4df5-b793-057239d092a6"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Wait for 1 hour -> check if Login Attempted in last 10 min",
            "targetStep": "\/api\/3\/workflow_steps\/335bf175-6398-469d-84ee-b58b662b1bc8",
            "sourceStep": "\/api\/3\/workflow_steps\/da4034be-85c6-470d-bd38-1621cf96c51f",
            "label": null,
            "isExecuted": false,
            "uuid": "f819a631-1cab-46af-a2fb-2202881f7a57"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note to Alert with searched data -> Add Note for Approval",
            "targetStep": "\/api\/3\/workflow_steps\/15457e8e-fc0a-4eaf-a53a-05113fed1469",
            "sourceStep": "\/api\/3\/workflow_steps\/6f86c9c1-b1a9-45e4-8ce0-f739cf20e629",
            "label": null,
            "isExecuted": false,
            "uuid": "838eb60f-d451-4582-a6ae-2637f2e55865"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note for Approval -> Send Approval for Login Disable",
            "targetStep": "\/api\/3\/workflow_steps\/a3ec6867-2bcd-442a-aefe-100d298b494b",
            "sourceStep": "\/api\/3\/workflow_steps\/15457e8e-fc0a-4eaf-a53a-05113fed1469",
            "label": null,
            "isExecuted": false,
            "uuid": "bfbf7e5e-6b40-4887-b632-147cdc8c550f"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Disable User Login -> Add note for pause",
            "targetStep": "\/api\/3\/workflow_steps\/9a955927-7e0f-42ba-b301-f550e778293f",
            "sourceStep": "\/api\/3\/workflow_steps\/7a18540b-2657-4078-828b-239494ae06ca",
            "label": null,
            "isExecuted": false,
            "uuid": "7737a454-e16d-4489-a317-f95f4845e541"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add note for pause -> Wait for 1 hour",
            "targetStep": "\/api\/3\/workflow_steps\/da4034be-85c6-470d-bd38-1621cf96c51f",
            "sourceStep": "\/api\/3\/workflow_steps\/9a955927-7e0f-42ba-b301-f550e778293f",
            "label": null,
            "isExecuted": false,
            "uuid": "2e822498-714a-4497-ba88-9bb0e04878ca"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Search users 4 hours of login data in fortisiem -> convert CEF to json",
            "targetStep": "\/api\/3\/workflow_steps\/a219b03c-e587-43ad-9cf1-c1f536ad50fd",
            "sourceStep": "\/api\/3\/workflow_steps\/b1c2486d-7a61-4543-8792-b140621133cf",
            "label": null,
            "isExecuted": false,
            "uuid": "daf27a33-7a08-4390-a7b9-bd25c4195e39"
        }
    ],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "4719c477-28f5-4d8d-9022-f70fe75ccb3d",
    "recordTags": [
        "ManualAction"
    ],
    "id": 981,
    "createUser": "\/api\/3\/appliances\/57545210-2adc-472b-a24f-2df6ee8dfe63",
    "createDate": 1636433427,
    "modifyUser": "\/api\/3\/appliances\/57545210-2adc-472b-a24f-2df6ee8dfe63",
    "modifyDate": 1636433427,
    "owners": [],
    "isPrivate": false
}