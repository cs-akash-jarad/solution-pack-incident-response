{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Remediate Malware Alert (Symantec EDR - ATP)",
    "aliasName": null,
    "tag": "#Post-Create#Alert",
    "description": "Remediate malware alert by blocking malicious entities",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "lastModifyDate": 1638437679,
    "collection": "\/api\/3\/workflow_collections\/59667fcc-7feb-4ba4-a5a2-e03a9287f857",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/0c9b6f1e-bf8f-4f04-8bd4-9c55ce85ae98",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Isolate Endpoint",
            "description": null,
            "arguments": {
                "name": "Symantec ATP",
                "config": "74785d28-4798-404e-92bc-4c0f0a01a1c4",
                "params": {
                    "targets": "{{vars.request.data.deviceUID}}"
                },
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Isolated the device,<strong>{{vars.request.data.deviceUID}}&nbsp;&nbsp;<\/strong>successfully.&nbsp;<\/p>",
                    "records": "['{{vars.alertIRI}}']"
                },
                "version": "1.0.0",
                "connector": "symantec-atp",
                "operation": "isolate_endpoint",
                "mock_result": "{\n       \"command_id\": \"12daad22ddd23s12daad22ddd23s-2018-04-27\"\n }",
                "operationTitle": "Isolate Endpoint",
                "step_variables": []
            },
            "status": null,
            "top": "1515",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "a565deb4-69a6-4e54-b687-78ad05569267",
            "id": 3501
        },
        {
            "@type": "WorkflowStep",
            "name": "Close Alert",
            "description": null,
            "arguments": {
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p><strong><span style=\"color: #339966;\">Asset Contained.<\/span><\/strong><\/p>",
                    "records": ""
                },
                "resource": {
                    "status": {
                        "id": 6802,
                        "@id": "\/api\/3\/picklists\/fac53e73-8d16-4189-98d5-95fbd1555232",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Closed",
                        "listName": "\/api\/3\/picklist_names\/33e964a9-d607-49f2-813c-7ce46141815a",
                        "itemValue": "Closed",
                        "orderIndex": 1
                    },
                    "closureNotes": "<p>Asset and user Containted<\/p>"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.alertIRI}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1920",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "21bd042e-cd39-499a-8df3-359dc0807951",
            "id": 3502
        },
        {
            "@type": "WorkflowStep",
            "name": "Fetch Assets Details",
            "description": null,
            "arguments": {
                "query": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "primitive",
                            "field": "deviceUid",
                            "value": "{{vars.input.records[0].deviceUID}}",
                            "operator": "eq",
                            "_operator": "eq"
                        }
                    ]
                },
                "module": "assets?$limit=30",
                "step_variables": []
            },
            "status": null,
            "top": "435",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928770",
            "uuid": "f9c2490b-121d-4d82-a159-11412e23996e",
            "id": 3503
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "resource": "alerts",
                "resources": [
                    "alerts"
                ],
                "step_variables": {
                    "input": {
                        "records": [
                            "{{vars.input.records[0]}}"
                        ]
                    }
                },
                "fieldbasedtrigger": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "object",
                            "field": "type",
                            "value": "\/api\/3\/picklists\/0cbc2c31-c360-4770-b1e7-3653a8c24ead",
                            "_value": {
                                "itemValue": "Malware"
                            },
                            "operator": "eq"
                        },
                        {
                            "type": "primitive",
                            "field": "source",
                            "value": "Symantec EDR",
                            "operator": "eq",
                            "_operator": "eq"
                        }
                    ]
                }
            },
            "status": null,
            "top": "30",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/ea155646-3821-4542-9702-b246da430a8d",
            "uuid": "0c9b6f1e-bf8f-4f04-8bd4-9c55ce85ae98",
            "id": 3504
        },
        {
            "@type": "WorkflowStep",
            "name": "Deactivate User in CloudSOC",
            "description": null,
            "arguments": {
                "name": "Symantec CloudSOC",
                "config": "3717065f-ef19-4c19-b038-5e3e0f86422f",
                "params": {
                    "email": "{{vars.steps.Fetch_Assets_Details[0].emailID}}",
                    "action": "Deactivate User"
                },
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>User:&nbsp;{{vars.steps.Fetch_Assets_Details[0].managedBy}} - has been blocked on Symantec CloudSOC<\/p>",
                    "records": ""
                },
                "version": "1.0.0",
                "connector": "symantec-cloudsoc",
                "operation": "modify_user",
                "mock_result": "{\n    \"data\":\n    {\n    \"Status\" : \"Success\"\n    }\n}",
                "operationTitle": "Modify User Activation",
                "step_variables": []
            },
            "status": null,
            "top": "1650",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "aa2a04ee-cd33-41e6-8f02-82a8f331eae9",
            "id": 3505
        },
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "alertIRI": "{{vars.input.records[0]['@id']}}",
                "alertRawData": "{{vars.input.records[0].sourceData}}",
                "useMockOutput": "{{globalVars.Demo_mode}}"
            },
            "status": null,
            "top": "165",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "db4e5979-dc36-4448-b0f0-1064ef2d5755",
            "id": 3506
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Note for Approved Isolation",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 247,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "uuid": "ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "['{{vars.alertIRI}}']",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p><strong><span style=\"color: #008000;\">Containment request approved.<\/span><\/strong><\/p>\n<p>Proceeding to Isolate the Host<\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1245",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "7667ce63-2b95-446e-9924-efcf7695558b",
            "id": 3507
        },
        {
            "@type": "WorkflowStep",
            "name": "Notify IT team to start the asset clean up process",
            "description": null,
            "arguments": {
                "name": "SMTP",
                "config": "8dcaad2a-8cc4-4156-a95e-87e420f76a1f",
                "params": {
                    "cc": "user@example.com",
                    "to": "cyopsit_team@example.com",
                    "bcc": "",
                    "from": "no-reply@cybersponse.com",
                    "content": "<p>Hi Team,<\/p>\n<p>Following asset has been isolated due to malware infection.<\/p>\n<p>Please initiate asset clean-up procedure.<\/p>\n<p>Asset details:<\/p>\n<table border=\"1px solid black\" style=\"width: 732px; float: left;\">\n<tbody>\n<tr>\n<td style=\"width: 95px;\">Owner<\/td>\n<td style=\"width: 286px;\">{{vars.steps.Fetch_Assets_Details[0].managedBy}}<\/td>\n<\/tr>\n<tr>\n<td style=\"width: 95px;\">Device Name<\/td>\n<td style=\"width: 286px;\">{{vars.steps.Fetch_Assets_Details[0].hostname}}<\/td>\n<\/tr>\n<tr>\n<td style=\"width: 95px;\">IP Address<\/td>\n<td style=\"width: 286px;\">{{vars.steps.Fetch_Assets_Details[0].ip}}<\/td>\n<\/tr>\n<tr>\n<td style=\"width: 95px;\">Owner's Email ID<\/td>\n<td style=\"width: 286px;\">{{vars.steps.Fetch_Assets_Details[0].emailID}}<\/td>\n<\/tr>\n<tr>\n<td style=\"width: 95px;\">OS<\/td>\n<td style=\"width: 286px;\">{{vars.steps.Fetch_Assets_Details[0].operatingSystem.itemValue}}<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<p>&nbsp;<\/p>\n<p>Infection details:<\/p>\n<table border=\"1px solid black\" style=\"width: 732px;\">\n<tbody>\n<tr>\n<td style=\"width: 146px;\">File Hashes&nbsp;<\/td>\n<td style=\"width: 237px;\">{% for item in vars.steps.Get_File_Reputation %}{% if \"Malicious\" in item.data.result.reputation %}{{item.data.result['SHA256']}}, {% endif %}{% endfor %}<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<p>&nbsp;<\/p>\n<p>Thanks,<\/p>\n<p>InfoSec Team<\/p>",
                    "subject": "Clean Infected Asset : {{vars.steps.Fetch_Assets_Details[0].hostname}}",
                    "iri_list": "",
                    "file_name": "",
                    "file_path": ""
                },
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Mailed IT Team to initiate the asset clean-up procedure.<\/p>",
                    "records": "['{{vars.alertIRI}}']"
                },
                "version": "2.4.2",
                "connector": "smtp",
                "operation": "send_richtext_email",
                "ignore_errors": true,
                "operationTitle": "Send Rich Text Email",
                "step_variables": []
            },
            "status": null,
            "top": "1785",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "1e0026cd-2b32-48c0-91a5-2900910e0c72",
            "id": 3508
        },
        {
            "@type": "WorkflowStep",
            "name": "No Isolation is required",
            "description": null,
            "arguments": {
                "params": [],
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>No Isolation of endpoint is required<\/p>",
                    "records": "['{{vars.alertIRI}}']"
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
            },
            "status": null,
            "top": "1245",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "183e4aca-e399-4128-9f9d-f95e67ff009c",
            "id": 3509
        },
        {
            "@type": "WorkflowStep",
            "name": "Create or Link Assets",
            "description": null,
            "arguments": {
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Found Asset details corresponding to the Device UID \"{{vars.request.data.deviceUID}}\":<br><strong>Owner<\/strong>:&nbsp;{{vars.steps.Fetch_Assets_Details[0].managedBy}} ({{vars.steps.Fetch_Assets_Details[0].emailId}})<br><strong>Hostname<\/strong>:&nbsp;{{vars.steps.Fetch_Assets_Details[0].hostname}}<br><strong>Asset Criticality<\/strong>:&nbsp;{{vars.steps.Fetch_Assets_Details[0].criticality.itemValue}}<\/p>",
                    "records": ""
                },
                "arguments": {
                    "assetIP": "",
                    "indicatorIRI": "{{vars.linkedIndicatorIRI}}",
                    "assetHostname": "{{vars.steps.Fetch_Assets_Details[0].hostname}}",
                    "alertRecordIRI": "{{vars.input.records[0]['@id']}}",
                    "incidentRecordIRI": ""
                },
                "apply_async": false,
                "step_variables": {
                    "linkedAssetIRI": "{{vars.result['@id']}}"
                },
                "workflowReference": "\/api\/3\/workflows\/24f12289-5860-4857-ac0e-354e65f46e18"
            },
            "status": null,
            "top": "570",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "uuid": "455faacc-3fb7-47e6-b2a7-cc1a67640c39",
            "id": 3510
        },
        {
            "@type": "WorkflowStep",
            "name": "Is Endpoint Isolation Required",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Yes",
                        "step_iri": "\/api\/3\/workflow_steps\/dc74508c-e164-4eec-91b8-f41f3b50ba99",
                        "condition": "{{ \"Malicious\" in vars.fileReputations }}"
                    },
                    {
                        "option": "No",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/9ea820a9-3ce3-44e8-9155-53fb3c002c1e"
                    }
                ]
            },
            "status": null,
            "top": "840",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "uuid": "32fc410a-1f0e-44ce-ab34-cd0c088c4e68",
            "id": 3511
        },
        {
            "@type": "WorkflowStep",
            "name": "Start Investigation",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<span style=\"font-size: 15px; color: #DE7A13;\" class=\"fa fa-exclamation-triangle\"><\/span>&nbsp;Investigating Potential {{vars.input.records[0].type.itemValue}}, with following fields of interest:\n{% if vars.input.records[0].domain %}Domain: {{vars.input.records[0].domain -}}{% endif %}\n{% if vars.input.records[0].sourceIp %}SourceIP: {{ vars.input.records[0].sourceIp -}}{% endif %}\n{% if vars.input.records[0].destinationIp %}DestinationIP: {{vars.input.records[0].destinationIp -}}{% endif %}\n{% if vars.input.records[0].fileHash %}File Hash: {{vars.input.records[0].fileHash -}}{% endif %}\n{% if vars.input.records[0].computerName %}ComputerName: {{vars.input.records[0].computerName -}}{% endif %}\n{% if vars.input.records[0].processName %}Process: {{vars.input.records[0].processName -}}{% endif %}\n{% if vars.input.records[0].sourceProcess %}SourceProcess: {{vars.input.records[0].sourceProcess -}}{% endif %}",
                    "records": ""
                },
                "resource": {
                    "status": {
                        "id": 113,
                        "@id": "\/api\/3\/picklists\/758925e7-629c-46d8-89db-fb36f5fbe88a",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Investigating",
                        "listName": "\/api\/3\/picklist_names\/33e964a9-d607-49f2-813c-7ce46141815a",
                        "itemValue": "Investigating",
                        "orderIndex": 2
                    }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "300",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "ec25a525-1a2d-433b-81bb-562fb34c04fd",
            "id": 3512
        },
        {
            "@type": "WorkflowStep",
            "name": "Create note for the approval",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 247,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "uuid": "ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "['{{vars.alertIRI}}']",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Requested Approval from&nbsp;SOC team member&nbsp;to contain the User and Asset.<br><strong> <span style=\"background:#ba6204; color: #fff;\" class=\"badge badge-pill badge-danger\">Awaiting Confirmation.<\/span><\/strong><\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "975",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "dc74508c-e164-4eec-91b8-f41f3b50ba99",
            "id": 3513
        },
        {
            "@type": "WorkflowStep",
            "name": "No malicious file found",
            "description": null,
            "arguments": {
                "params": [],
                "message": {
                    "tenant": "{{vars.input.records[0].type['@id']}}",
                    "content": "<p><strong><span style=\"color: #339966;\">No malicious<\/span><\/strong>&nbsp;File found<\/p>",
                    "records": ""
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
            },
            "status": null,
            "top": "975",
            "left": "650",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "9ea820a9-3ce3-44e8-9155-53fb3c002c1e",
            "id": 3514
        },
        {
            "@type": "WorkflowStep",
            "name": "Get File Reputation",
            "description": null,
            "arguments": {
                "name": "Symantec DeepSight Intelligence",
                "config": "caf0ac75-91ae-46ba-b9e1-ac82128fd442",
                "params": {
                    "filehash": "{{vars.input.records[0].fileHash}}"
                },
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p><strong>Symantec DeepSight<\/strong>&nbsp;suggests Filehash&nbsp;{{vars.result[0].data.result.MD5}} to be&nbsp;<strong> <span style=\"background:#ba6204; color: #fff;\" class=\"badge badge-pill badge-danger\">{{vars.result[0].data.result.reputation}}<\/span><\/strong><\/p>",
                    "records": ""
                },
                "version": "1.0.1",
                "connector": "symantec-deepsight-intelligence",
                "operation": "filehash_reputation",
                "mock_result": "[\n    {\n      \"status\": \"Success\",\n      \"data\": {\n        \"status\": \"success\",\n        \"result\": {\n          \"MD5\": \"dc4200ac514006f084ead7f83b84c928\",\n          \"reputation\": \"Malicious\",\n          \"schemaVersion\": 3,\n          \"activity\": {\n            \"tcp\": [\n              {\n                \"port\": 443,\n                \"ip\": \"13.92.82.125\"\n              },\n              {\n                \"port\": 443,\n                \"ip\": \"131.253.61.102\"\n              },\n              {\n                \"port\": 80,\n                \"ip\": \"23.192.125.50\"\n              },\n              {\n                \"port\": 80,\n                \"ip\": \"72.21.91.29\"\n              },\n              {\n                \"port\": 80,\n                \"ip\": \"104.18.24.243\"\n              },\n              {\n                \"port\": 80,\n                \"ip\": \"208.185.118.90\"\n              }\n            ],\n            \"dns\": [\n              {\n                \"type\": \"A\",\n                \"target\": \"login.live.com\"\n              },\n              {\n                \"type\": \"A\",\n                \"target\": \"ocsp.digicert.com\"\n              },\n              {\n                \"type\": \"A\",\n                \"target\": \"ocsp.msocsp.com\"\n              },\n              {\n                \"type\": \"A\",\n                \"target\": \"crl.microsoft.com\"\n              }\n            ],\n            \"urls\": [\n              {\n                \"url\": \"http:\/\/ocsp.digicert.com\/MFEwTzBNMEswSTAJBgUrDgMCGgUABBTBL0V27RVZ7LBduom%2FnYB45SPUEwQU5Z1ZMIJHWMys%2BghUNoZ7OrUETfACEAi4elAbvpzaLRZNPjlRv1U%3D\"\n              },\n              {\n                \"url\": \"http:\/\/ocsp.msocsp.com\/MFQwUjBQME4wTDAJBgUrDgMCGgUABBRPC1vZt9qvn7bzY3Iidtbhla4mKQQUWIif1tycSCK3FD7%2FhIjo5oX%2F%2Bn0CE3sAACKeWuj3CySHT1IAAAAAIp4%3D\"\n              },\n              {\n                \"url\": \"http:\/\/crl.microsoft.com\/pki\/crl\/products\/tspca.crl\"\n              }\n            ],\n            \"udp\": [\n              {\n                \"port\": 3702,\n                \"ip\": \"239.255.255.250\"\n              }\n            ]\n          },\n          \"detectionName\": \"Infostealer.Chabibase\",\n          \"SHA256\": \"a850de0705c0f6095910aa1d5ed0e73a49581aa7427fcfaf2ff5144e93b047c1\"\n        }\n      },\n      \"operation\": \"filehash_reputation\",\n      \"message\": \"\"\n    }\n  ]",
                "operationTitle": "Get File Reputation",
                "step_variables": {
                    "fileReputations": "{{vars.result | json_query(\"[*].data.result.reputation\")}}"
                }
            },
            "status": null,
            "top": "705",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "39ab8d7b-7353-484d-9042-9c27a75a51d3",
            "id": 3515
        },
        {
            "@type": "WorkflowStep",
            "name": "Seek approval to contain",
            "description": null,
            "arguments": {
                "type": "DecisionBased",
                "input": {
                    "schema": {
                        "title": "Approve Containment",
                        "description": "<p>Alert ID: {{vars.request.data.id}}<br \/>Please provide approval to contain <br \/>User ({{vars.steps.Fetch_Assets_Details[0].emailId}}) and <br \/>Endpoint (Device UID: {{vars.request.data.deviceUID}})<\/p>",
                        "inputVariables": []
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "owner_detail": {
                    "isAssigned": false
                },
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Approve",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/7667ce63-2b95-446e-9924-efcf7695558b"
                        },
                        {
                            "option": "Reject",
                            "step_iri": "\/api\/3\/workflow_steps\/183e4aca-e399-4128-9f9d-f95e67ff009c"
                        }
                    ],
                    "duplicateOption": false
                }
            },
            "status": null,
            "top": "1110",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "uuid": "7ddfa1ab-b9af-459b-9b35-f60a46447a3d",
            "id": 3516
        },
        {
            "@type": "WorkflowStep",
            "name": "Delete File from Endpoint",
            "description": null,
            "arguments": {
                "name": "Symantec ATP",
                "config": "eef74f1f-3d37-4b64-b774-8398ce9f548d",
                "params": {
                    "hash": "{{vars.item.data.result['SHA256']}}",
                    "device_uid": "{{vars.request.data.deviceUID}}"
                },
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Deleted the&nbsp;<strong><span style=\"background:#e31b1d; color: #fff;\" class=\"badge badge-pill badge-danger\">malicious<\/span>&nbsp;<\/strong>file hashes from device&nbsp;<strong><span style=\"background:#e31b1d; color: #fff;\" class=\"badge badge-pill badge-danger\">{{vars.request.data.deviceUID}}<\/span><\/strong><\/p>",
                    "records": "['{{vars.alertIRI}}']"
                },
                "version": "1.0.0",
                "for_each": {
                    "item": "{{vars.steps.Get_File_Reputation}}",
                    "condition": "{{\"Malicious\" in vars.item.data.result.reputation or \"Trending Bad\" in vars.item.data.result.reputation}}"
                },
                "connector": "symantec-atp",
                "operation": "delete_endpoint_file",
                "mock_result": "[\n  {\n    \"command_id\": \"12daad562ddd23s12daad22ddd23s-2018-04-27\"\n  },\n  {\n    \"command_id\": \"12daad22ddd23s12daass2asd23s-2018-04-27\"\n  }\n]",
                "operationTitle": "Delete Endpoint File",
                "step_variables": []
            },
            "status": null,
            "top": "1380",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "2141711f-6338-48ce-a1a0-0e3986897ddd",
            "id": 3517
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Get File Reputation -> Is Endpoint Isolation Required",
            "targetStep": "\/api\/3\/workflow_steps\/32fc410a-1f0e-44ce-ab34-cd0c088c4e68",
            "sourceStep": "\/api\/3\/workflow_steps\/39ab8d7b-7353-484d-9042-9c27a75a51d3",
            "label": null,
            "isExecuted": false,
            "uuid": "725236e0-f698-4759-af54-2f902913da52"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Seek approval to contain -> No Isolation is required",
            "targetStep": "\/api\/3\/workflow_steps\/183e4aca-e399-4128-9f9d-f95e67ff009c",
            "sourceStep": "\/api\/3\/workflow_steps\/7ddfa1ab-b9af-459b-9b35-f60a46447a3d",
            "label": "Reject",
            "isExecuted": false,
            "uuid": "1d0ae3d3-4ff5-4bd2-a835-1c7e4b09bc6f"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start Investigation -> Fetch Assets Details",
            "targetStep": "\/api\/3\/workflow_steps\/f9c2490b-121d-4d82-a159-11412e23996e",
            "sourceStep": "\/api\/3\/workflow_steps\/ec25a525-1a2d-433b-81bb-562fb34c04fd",
            "label": null,
            "isExecuted": false,
            "uuid": "0011eb93-2ded-4421-b8e5-2f92d0711a93"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Endpoint Isolation Required -> No malicious file found1",
            "targetStep": "\/api\/3\/workflow_steps\/9ea820a9-3ce3-44e8-9155-53fb3c002c1e",
            "sourceStep": "\/api\/3\/workflow_steps\/32fc410a-1f0e-44ce-ab34-cd0c088c4e68",
            "label": "No",
            "isExecuted": false,
            "uuid": "c44b8460-8c69-451e-843d-6a34c42dceb5"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Fetch Assets Details -> Create or Link Assets",
            "targetStep": "\/api\/3\/workflow_steps\/455faacc-3fb7-47e6-b2a7-cc1a67640c39",
            "sourceStep": "\/api\/3\/workflow_steps\/f9c2490b-121d-4d82-a159-11412e23996e",
            "label": null,
            "isExecuted": false,
            "uuid": "cfc2f562-d5bc-4082-9612-332d7ec96a86"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Seek approval to contain -> Create Note for Approved Isolation",
            "targetStep": "\/api\/3\/workflow_steps\/7667ce63-2b95-446e-9924-efcf7695558b",
            "sourceStep": "\/api\/3\/workflow_steps\/7ddfa1ab-b9af-459b-9b35-f60a46447a3d",
            "label": "Approve",
            "isExecuted": false,
            "uuid": "8791a8d7-2740-40c0-b2a7-0cb5677057f8"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create Note for Approved Isolation -> Delete File from Endpoint",
            "targetStep": "\/api\/3\/workflow_steps\/2141711f-6338-48ce-a1a0-0e3986897ddd",
            "sourceStep": "\/api\/3\/workflow_steps\/7667ce63-2b95-446e-9924-efcf7695558b",
            "label": null,
            "isExecuted": false,
            "uuid": "938d48c9-982f-4b05-8c02-09bd37c2230a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Isolate Endpoint -> Deactivate User in CloudSOC",
            "targetStep": "\/api\/3\/workflow_steps\/aa2a04ee-cd33-41e6-8f02-82a8f331eae9",
            "sourceStep": "\/api\/3\/workflow_steps\/a565deb4-69a6-4e54-b687-78ad05569267",
            "label": null,
            "isExecuted": false,
            "uuid": "58a2a1a3-6e16-4236-9c78-a66a6fc34265"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/db4e5979-dc36-4448-b0f0-1064ef2d5755",
            "sourceStep": "\/api\/3\/workflow_steps\/0c9b6f1e-bf8f-4f04-8bd4-9c55ce85ae98",
            "label": null,
            "isExecuted": false,
            "uuid": "7c1f669e-5c18-4519-974d-f019b36e48bf"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Start Investigation",
            "targetStep": "\/api\/3\/workflow_steps\/ec25a525-1a2d-433b-81bb-562fb34c04fd",
            "sourceStep": "\/api\/3\/workflow_steps\/db4e5979-dc36-4448-b0f0-1064ef2d5755",
            "label": null,
            "isExecuted": false,
            "uuid": "98279fdf-bb86-4e9d-aec3-c0e48512718e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "is Endpoint Isolation Required -> Create note for the approval",
            "targetStep": "\/api\/3\/workflow_steps\/dc74508c-e164-4eec-91b8-f41f3b50ba99",
            "sourceStep": "\/api\/3\/workflow_steps\/32fc410a-1f0e-44ce-ab34-cd0c088c4e68",
            "label": "Yes",
            "isExecuted": false,
            "uuid": "fef3abd1-6a4a-4b2f-86bf-73996c8f8c79"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create note for the approval -> Seek approval to contain",
            "targetStep": "\/api\/3\/workflow_steps\/7ddfa1ab-b9af-459b-9b35-f60a46447a3d",
            "sourceStep": "\/api\/3\/workflow_steps\/dc74508c-e164-4eec-91b8-f41f3b50ba99",
            "label": null,
            "isExecuted": false,
            "uuid": "491f6e1e-c9ee-4829-8aba-d3fb811a6f68"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Notify IT team to start the asset clean up process -> Closing Alert record",
            "targetStep": "\/api\/3\/workflow_steps\/21bd042e-cd39-499a-8df3-359dc0807951",
            "sourceStep": "\/api\/3\/workflow_steps\/1e0026cd-2b32-48c0-91a5-2900910e0c72",
            "label": null,
            "isExecuted": false,
            "uuid": "8ee1a8a5-2a2e-4f7e-92b2-521376421033"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Delete File from Endpoint -> Isolate Endpoint",
            "targetStep": "\/api\/3\/workflow_steps\/a565deb4-69a6-4e54-b687-78ad05569267",
            "sourceStep": "\/api\/3\/workflow_steps\/2141711f-6338-48ce-a1a0-0e3986897ddd",
            "label": null,
            "isExecuted": false,
            "uuid": "21cc93fa-e8cf-4df4-ab43-1fade9f7512d"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create or Link Assets -> Get File Reputation",
            "targetStep": "\/api\/3\/workflow_steps\/39ab8d7b-7353-484d-9042-9c27a75a51d3",
            "sourceStep": "\/api\/3\/workflow_steps\/455faacc-3fb7-47e6-b2a7-cc1a67640c39",
            "label": null,
            "isExecuted": false,
            "uuid": "290b2a01-1a31-4536-936b-b0a58fcbba78"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Deactivate User in CloudSOC -> Notify IT team to start the asset clean up process",
            "targetStep": "\/api\/3\/workflow_steps\/1e0026cd-2b32-48c0-91a5-2900910e0c72",
            "sourceStep": "\/api\/3\/workflow_steps\/aa2a04ee-cd33-41e6-8f02-82a8f331eae9",
            "label": null,
            "isExecuted": false,
            "uuid": "8f2112d8-eba5-44de-89c1-d531e8d1a29a"
        }
    ],
    "priority": null,
    "uuid": "3f11ef71-f1c7-497d-af2d-9f9b6be061d0",
    "recordTags": [
        "PostCreate",
        "Alerts"
    ],
    "id": 1010,
    "createUser": "\/api\/3\/appliances\/57545210-2adc-472b-a24f-2df6ee8dfe63",
    "createDate": 1638352093,
    "modifyUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "modifyDate": 1638437678,
    "owners": [],
    "isPrivate": false
}